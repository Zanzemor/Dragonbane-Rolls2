<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Rolador por Jogador</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f2f5;
            padding: 10px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .botao {
            background-color: #1877f2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            margin: 8px;
            cursor: pointer;
        }

        .historico {
            background-color: white;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .bloqueado {
            background-color: #ffcccc !important;
            cursor: not-allowed !important;
        }

        .rolagem-item {
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }

        #avisos {
            color: #ff0000;
            font-weight: bold;
            margin: 10px 0;
        }

        #contador {
            color: #666;
            text-align: center;
            margin: 10px 0;
        }

        .senha-container {
            display: none;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="contador"></div>
        
        <div class="historico">
            <h3>Hist√≥rico de Rolagens</h3>
            <div id="ultimasRolagens"></div>
        </div>

        <input type="text" id="playerName" placeholder="Digite seu nome">
        <div id="avisos"></div>
        
        <div id="senhaContainer" class="senha-container">
            <input type="password" id="senhaInput" placeholder="Senha de desbloqueio">
            <button class="botao" onclick="desbloquearNome()">üîì Desbloquear</button>
        </div>

        <button class="botao" onclick="rolar4d6()" id="rolarBtn">
            üé≤ Rolar 4d6 (3 maiores)
        </button>
    </div>

    <script>
        const SENHA_DESBLOQUEIO = "joaod";
        let contadorRolagens = {};
        let historico = {};
        let nomesBloqueados = new Set();

        function atualizarInterface() {
            const nome = document.getElementById('playerName').value.trim().toLowerCase();
            const contador = contadorRolagens[nome] || 0;
            
            document.getElementById('contador').innerHTML = `
                Rolagens restantes para <strong>${nome || '...'}</strong>: ${7 - contador}
            `;

            document.getElementById('senhaContainer').style.display = 
                nomesBloqueados.has(nome) ? 'block' : 'none';

            document.getElementById('ultimasRolagens').innerHTML = 
                (historico[nome] || []).map(roll => `
                    <div class="rolagem-item">
                        ${roll.data}<br>
                        ${roll.resultado.replace(/\n/g, '<br>')}
                    </div>
                `).join('') || "Nenhuma rolagem para este nome";
        }

        function verificarBloqueio(nome) {
            if(nomesBloqueados.has(nome)) {
                document.getElementById('avisos').innerHTML = "‚õî Nome bloqueado!";
                document.getElementById('rolarBtn').classList.add('bloqueado');
                return true;
            }
            return false;
        }

        function desbloquearNome() {
            const nome = document.getElementById('playerName').value.trim().toLowerCase();
            const senha = document.getElementById('senhaInput').value;

            if(senha === SENHA_DESBLOQUEIO) {
                nomesBloqueados.delete(nome);
                contadorRolagens[nome] = 0;
                document.getElementById('senhaInput').value = '';
                document.getElementById('avisos').innerHTML = "üîì Nome desbloqueado!";
                document.getElementById('rolarBtn').classList.remove('bloqueado');
                atualizarInterface();
            } else {
                document.getElementById('avisos').innerHTML = "‚ùå Senha incorreta!";
            }
        }

        function rolar4d6() {
            const nome = document.getElementById('playerName').value.trim().toLowerCase();
            
            if(!nome) {
                document.getElementById('avisos').innerHTML = "‚ö† Digite um nome v√°lido!";
                return;
            }

            if(verificarBloqueio(nome)) return;

            // Verificar limite
            if((contadorRolagens[nome] || 0) >= 7) {
                nomesBloqueados.add(nome);
                document.getElementById('avisos').innerHTML = "‚õî Limite de 7 rolagens atingido!";
                document.getElementById('rolarBtn').classList.add('bloqueado');
                return;
            }

            // Fazer rolagem
            const dados = Array.from({length: 4}, () => Math.floor(Math.random() * 6) + 1);
            const sorted = [...dados].sort((a, b) => b - a);
            const total = sorted.slice(0, 3).reduce((a, b) => a + b, 0);
            
            const resultado = {
                data: new Date().toLocaleString(),
                resultado: üé≤ Rolagem: ${dados.join(', ')}\n‚úÖ Mantidos: ${sorted.slice(0, 3).join(', ')}\n‚ùå Descartado: ${sorted[3]}\nüíØ Total: ${total}
            };

            // Atualizar registros
            contadorRolagens[nome] = (contadorRolagens[nome] || 0) + 1;
            historico[nome] = [...(historico[nome] || []), resultado];
            
            atualizarInterface();
            document.getElementById('avisos').innerHTML = "";
        }

        // Event listeners
        document.getElementById('playerName').addEventListener('input', function() {
            document.getElementById('rolarBtn').classList.remove('bloqueado');
            document.getElementById('avisos').innerHTML = "";
            atualizarInterface();
        });

        // Inicializa√ß√£o
        atualizarInterface();
    </script>
</body>
</html>